<!doctype html>
<html lang="pt-br">
<head><meta charset="utf-8"><title>Catálogo</title></head>
<body>
  <h1>Catálogo</h1>
  <button id="seed">Seed (1x)</button>
  <ul id="list"></ul>
  <button id="buy">Comprar PROD-0001</button>

  <script>
  document.getElementById('seed').onclick = async () => {
    const r = await fetch('/api/_seed?token=E2E_SEED_123');
    alert(await r.text());
    load();
  };

  async function load(){
    const r = await fetch('/api/products?page=1&pageSize=10');
    const j = await r.json();
    const ul = document.getElementById('list'); ul.innerHTML='';
    j.products.forEach(p=>{
      const li = document.createElement('li');
      li.textContent = `${p.id} — ${p.title} — R$ ${p.price.final} — estoque ${p.stock.quantity}`;
      ul.appendChild(li);
    });
  }
  document.getElementById('buy').onclick = async () => {
    const r = await fetch('/api/orders', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ buyer:{ name:'Aluno Demo', email:'aluno@demo.com' }, items:[{ productId:'PROD-0001', qty:1 }] })
    });
    console.log(await r.json());
    load();
  };
  load();
  </script>
</body>
</html>
